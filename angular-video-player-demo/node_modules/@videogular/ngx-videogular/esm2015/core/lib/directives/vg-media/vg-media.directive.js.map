{"version":3,"file":"vg-media.directive.js","sourceRoot":"../../../../../libs/ngx-videogular/core/src/","sources":["lib/directives/vg-media/vg-media.directive.ts"],"names":[],"mappings":";;;;;AAAA,OAAO,EACL,SAAS,EAGT,KAAK,EACL,iBAAiB,GAClB,MAAM,eAAe,CAAC;AACvB,OAAO,EACL,UAAU,EAEV,OAAO,EACP,SAAS,EACT,KAAK,EACL,aAAa,GACd,MAAM,MAAM,CAAC;AACd,OAAO,EAAE,GAAG,EAAE,MAAM,gBAAgB,CAAC;AAMrC,OAAO,EAAE,YAAY,EAAE,MAAM,sCAAsC,CAAC;AACpE,OAAO,EAAE,QAAQ,EAAE,MAAM,yCAAyC,CAAC;AACnE,OAAO,EAAE,QAAQ,EAAE,MAAM,yCAAyC,CAAC;AAKnE,MAAM,OAAO,gBAAgB;;;;;IAkD3B,YAAoB,GAAiB,EAAU,GAAsB;QAAjD,QAAG,GAAH,GAAG,CAAc;QAAU,QAAG,GAAH,GAAG,CAAmB;QA5CrE,UAAK,GAAW,QAAQ,CAAC,SAAS,CAAC;QAEnC,SAAI,GAAQ,EAAE,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;QAC9C,WAAM,GAAQ,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;QAIzB,YAAO,GAAG,KAAK,CAAC;QAChB,mBAAc,GAAG,KAAK,CAAC;QACvB,qBAAgB,GAAG,KAAK,CAAC;QACzB,cAAS,GAAG,KAAK,CAAC;QAClB,gBAAW,GAAG,KAAK,CAAC;QACpB,WAAM,GAAG,KAAK,CAAC;QAEf,qBAAgB,GAAG,KAAK,CAAC;QAEzB,kBAAa,GAAG,GAAG,CAAC;QACpB,mBAAc,GAAG,CAAC,CAAC;QACnB,gBAAW,GAAG,CAAC,CAAC;QAMhB,kBAAa,GAAG,KAAK,CAAC;QAgBtB,mBAAc,GAAqB,IAAI,OAAO,EAAE,CAAC;IAIuB,CAAC;;;;IAEzE,QAAQ;QACN,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;YACzB,wBAAwB;YACxB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC;SAC1B;aAAM;YACL,wBAAwB;YACxB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;SAC/B;QAED,+EAA+E;QAC/E,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAE7B,IAAI,CAAC,aAAa,GAAG;;YAEnB,KAAK,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC;YACrD,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,WAAW,CAAC;YAC1D,cAAc,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,mBAAmB,CAAC;YACzE,cAAc,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,kBAAkB,CAAC;YACxE,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,SAAS,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,YAAY,CAAC;YAC7D,KAAK,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC;YACrD,KAAK,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC;YACrD,UAAU,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,cAAc,CAAC;YAChE,cAAc,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,kBAAkB,CAAC;YACxE,SAAS,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,aAAa,CAAC;YAC9D,KAAK,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC;YACrD,IAAI,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,OAAO,CAAC;YACnD,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,QAAQ,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,WAAW,CAAC;YAC3D,UAAU,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,cAAc,CAAC;YAChE,MAAM,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,SAAS,CAAC;YACvD,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,UAAU,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,cAAc,CAAC;YAChE,YAAY,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,gBAAgB,CAAC;YACpE,OAAO,EAAE,SAAS,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;;YAGzD,QAAQ,EAAE,SAAS,CAAC,mBAAA,MAAM,EAAO,EAAE,QAAQ,CAAC,YAAY,CAAC;YACzD,MAAM,EAAE,SAAS,CAAC,mBAAA,MAAM,EAAO,EAAE,QAAQ,CAAC,UAAU,CAAC;;YAGrD,QAAQ,EAAE,IAAI,UAAU;;;;YAAC,CAAC,QAAa,EAAE,EAAE;;sBACnC,MAAM,GAAG,IAAI,gBAAgB;;;;gBAAC,CAAC,SAAS,EAAE,EAAE;oBAChD,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBAC3B,CAAC,EAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,mBAAA,IAAI,CAAC,IAAI,EAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;gBAExE;;;gBAAO,GAAG,EAAE;oBACV,MAAM,CAAC,UAAU,EAAE,CAAC;gBACtB,CAAC,EAAC;YACJ,CAAC,EAAC;;YAGF,cAAc,EAAE,IAAI,CAAC,cAAc;SACpC,CAAC;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CACtD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAC3B,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAC1B,CAAC;QACF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,SAAS,CAClE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CACjC,CAAC;QACF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,SAAS,CAClE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAC/B,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CACpD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CACvB,CAAC;QACF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CACtD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAC3B,CAAC;QACF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAChD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAC3B,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CACpD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAC/B,CAAC;QACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACzE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5E,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,SAAS,CAC1D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAC7B,CAAC;QACF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,SAAS,CAC9D,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAC/B,CAAC;QACF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAE5E,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,SAAS;;;YAAC,GAAG,EAAE;gBACvC,IAAI,CAAC,WAAW,EAAE,CAAC;YACrB,CAAC,EAAC,CAAC;SACJ;IACH,CAAC;;;;IAED,WAAW;;cACH,UAAU,GAAsB,EAAE;QAExC,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;YACnC,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;gBAC1B,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;aAC/D;SACF;QAED,IAAI,CAAC,sBAAsB,GAAG,aAAa,CAAC,UAAU,CAAC;aACpD,IAAI,CAAC,GAAG;;;;QAAC,CAAC,GAAG,MAAM,EAAE,EAAE;;kBAChB,eAAe;;;;YAAG,CAAC,KAAK,EAAE,EAAE;gBAChC,IAAI,EAAC,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,MAAM,CAAA,EAAE;oBAClB,OAAO,KAAK,CAAC;iBACd;gBAED,OAAO,KAAK,CAAC,MAAM,CAAC,UAAU,KAAK,CAAC,CAAC;YACvC,CAAC,CAAA;;kBAEK,QAAQ,GAAY,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;YAEtD,IAAI,QAAQ,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;gBACtC,IAAI,CAAC,SAAS,EAAE,CAAC;gBACjB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;aACrC;QACH,CAAC,EAAC,CAAC;aACF,SAAS,EAAE,CAAC;IACjB,CAAC;;;;IAED,SAAS;QACP,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,SAAS;;;QAAC,GAAG,EAAE;YACpD,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;gBACnC,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;;0BAC7B,IAAI,GACR,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW;oBAEvD,IAAI,IAAI,GAAG,CAAC,GAAG,IAAI,IAAI,GAAG,GAAG,EAAE;wBAC7B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,KAAK,QAAQ,CAAC,UAAU,CAAC;wBAExD,IAAI,CAAC,KAAK,EAAE,CAAC;wBACb,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC;wBAC/B,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;qBACvD;yBAAM;wBACL,IAAI,IAAI,CAAC,aAAa,EAAE;4BACtB,IAAI,CAAC,IAAI,EAAE,CAAC;4BACZ,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;4BAC9B,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;yBAC5B;qBACF;iBACF;aACF;QACH,CAAC,EAAC,CAAC;IACL,CAAC;;;;;IAED,UAAU,CAAC,SAAgC;QACzC,2DAA2D;QAC3D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;;kBAC1C,GAAG,GAAmB,SAAS,CAAC,CAAC,CAAC;YAExC,IAAI,GAAG,CAAC,IAAI,KAAK,YAAY,IAAI,GAAG,CAAC,aAAa,KAAK,KAAK,EAAE;gBAC5D,iEAAiE;gBACjE,IACE,CAAC,mBAAA,GAAG,CAAC,MAAM,EAAO,CAAC,CAAC,GAAG;oBACvB,CAAC,mBAAA,GAAG,CAAC,MAAM,EAAO,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC;oBAClC,CAAC,mBAAA,GAAG,CAAC,MAAM,EAAO,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAC5C;oBACA,IAAI,CAAC,SAAS,EAAE,CAAC;oBACjB,MAAM;iBACP;aACF;iBAAM,IACL,GAAG,CAAC,IAAI,KAAK,WAAW;gBACxB,GAAG,CAAC,YAAY,CAAC,MAAM;gBACvB,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,WAAW,EAAE,KAAK,QAAQ,EACvD;gBACA,IAAI,CAAC,SAAS,EAAE,CAAC;gBACjB,MAAM;aACP;SACF;IACH,CAAC;;;;IAED,SAAS;QACP,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QACrB,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,CAAC,CAAC;QAE7B,mDAAmD;QACnD,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAC7B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAEhD,yGAAyG;QACzG,UAAU;;;QAAC,GAAG,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,GAAE,EAAE,CAAC,CAAC;IAC5C,CAAC;;;;IAED,IAAI;QACF,mCAAmC;QACnC,IACE,IAAI,CAAC,WAAW;YAChB,CAAC,IAAI,CAAC,KAAK,KAAK,QAAQ,CAAC,SAAS,IAAI,IAAI,CAAC,KAAK,KAAK,QAAQ,CAAC,QAAQ,CAAC,EACvE;YACA,OAAO;SACR;QAED,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;QAEvC,iCAAiC;QACjC,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE;YACvE,IAAI,CAAC,WAAW;iBACb,IAAI;;;YAAC,GAAG,EAAE;gBACT,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YAC1B,CAAC,EAAC;iBACD,KAAK;;;YAAC,GAAG,EAAE;gBACV,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,0DAA0D;YAC5D,CAAC,EAAC,CAAC;SACN;QAED,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;;;;IAED,KAAK;QACH,iCAAiC;QACjC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI;;;YAAC,GAAG,EAAE;gBACzB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;YACvB,CAAC,EAAC,CAAC;SACJ;aAAM;YACL,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;SACtB;IACH,CAAC;;;;IAED,IAAI,EAAE;;;YAEA,MAAW;QAEf,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC;SAC1B;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;;;;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,QAAQ;YACvC,CAAC,CAAC,IAAI,CAAC,iBAAiB;YACxB,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC5B,CAAC;;;;;IAED,IAAI,WAAW,CAAC,OAAO;QACrB,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;QACnC,8DAA8D;IAChE,CAAC;;;;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;IAClC,CAAC;;;;;IAED,IAAI,MAAM,CAAC,MAAM;QACf,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;IAC/B,CAAC;;;;IAED,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;IAC7B,CAAC;;;;;IAED,IAAI,YAAY,CAAC,IAAI;QACnB,IAAI,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;IACnC,CAAC;;;;IAED,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;IACnC,CAAC;;;;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC/B,CAAC;;;;IAED,IAAI,UAAU;QACZ,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC;IACjC,CAAC;;;;;;IAED,SAAS,CAAC,KAAU;QAClB,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAChD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,gBAAgB,CAAC,KAAU;QACzB,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAChD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;QAC3B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,cAAc,CAAC,KAAU;QACvB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAE7B,IAAI,CAAC,IAAI,GAAG;YACV,OAAO,EAAE,CAAC;YACV,IAAI,EAAE,CAAC;YACP,KAAK,EAAE,IAAI,CAAC,QAAQ,GAAG,IAAI;SAC5B,CAAC;QAEF,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,SAAS,CAAC;;;cAG1B,CAAC,GAAW,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;QAC7C,IAAI,CAAC,MAAM,GAAG,CAAC,KAAK,QAAQ,CAAC;QAC7B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,MAAM,CAAC,KAAU;QACf,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,UAAU,CAAC,KAAU;QACnB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,QAAQ,CAAC;QAC/B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,cAAc,CAAC,KAAU;QACvB,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC;QACjC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,MAAM,CAAC,KAAU;QACf,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC;QAEjC,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAC1D,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB;SACF;QAED,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,OAAO,CAAC,KAAU;QAChB,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,SAAS,CAAC;QAEhC,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;aACrC;SACF;QAED,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,YAAY,CAAC,KAAU;;cACf,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC;QAEpC,IAAI,CAAC,IAAI,GAAG;YACV,OAAO,EAAE,IAAI,CAAC,WAAW,GAAG,IAAI;YAChC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK;YACtB,IAAI,EAAE,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,IAAI;SAChD,CAAC;QAEF,IAAI,GAAG,IAAI,CAAC,EAAE;YACZ,IAAI,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,UAAU,CAAC,KAAU;;cACb,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC;QAEpC,IAAI,GAAG,IAAI,CAAC,EAAE;YACZ,IAAI,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,cAAc,CAAC,KAAU;QACvB,gDAAgD;QAChD,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;;IAED,OAAO,CAAC,KAAU;QAChB,8BAA8B;QAC9B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;;;;;IAGD,WAAW;;cACH,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa;QACrC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC;QAEvC,IACE,CAAC,IAAI,CAAC,gBAAgB;YACtB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,GAAG,MAAM,EAC/C;YACA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAC9B;QAED,IACE,IAAI,CAAC,gBAAgB;YACrB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,GAAG,MAAM,EAC/C;YACA,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;SAC/B;QAED,kEAAkE;QAClE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE;YAC/B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;SACjD;QAED,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC;IACzC,CAAC;;;;IAED,gBAAgB;QACd,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,SAAS;;;QACnE,GAAG,EAAE;YACH,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC,EACF,CAAC;IACJ,CAAC;;;;IAED,eAAe;QACb,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAChC,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;SAC5C;QAED,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAE9B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;IAClD,CAAC;;;;;;IAED,QAAQ,CAAC,KAAa,EAAE,YAAqB,KAAK;;YAC5C,MAAc;;cACZ,QAAQ,GAAW,IAAI,CAAC,QAAQ;QAEtC,IAAI,SAAS,EAAE;YACb,MAAM,GAAG,CAAC,KAAK,GAAG,QAAQ,CAAC,GAAG,GAAG,CAAC;SACnC;aAAM;YACL,MAAM,GAAG,KAAK,CAAC;SAChB;QAED,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC;IAC5B,CAAC;;;;;;;;IAED,YAAY,CACV,IAAY,EACZ,KAAc,EACd,QAAiB,EACjB,IAAwC;;cAElC,QAAQ,GAAc,IAAI,CAAC,OAAO,CAAC,YAAY,CACnD,IAAI,EACJ,KAAK,EACL,QAAQ,CACT;QAED,IAAI,IAAI,EAAE;YACR,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;SACtB;QACD,OAAO,QAAQ,CAAC;IAClB,CAAC;;;;IAED,WAAW;QACT,IAAI,CAAC,OAAO,CAAC,GAAG,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;QAC/B,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;QAC9B,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;QACrC,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;QACrC,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;QAC9B,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;QAC/B,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;QAC5B,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;QAC9B,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;QAC3B,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;QAC5B,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;QACjC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,CAAC;QACnC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;QAE5B,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAChC,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;SAC5C;QAED,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;SACrC;QAED,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;QAC/B,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;QAElC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IACjC,CAAC;;;YAliBF,SAAS,SAAC;gBACT,QAAQ,EAAE,WAAW;aACtB;;;;YANQ,YAAY;YAhBnB,iBAAiB;;;sBA0BhB,KAAK;uBACL,KAAK;;;;IAHN,gCAAU;;IAEV,mCAAgC;;IAChC,oCAA2B;;IAE3B,iCAAmC;;IAEnC,gCAA8C;;IAC9C,kCAAyB;;IACzB,iCAAW;;IACX,yCAAyC;;IAEzC,mCAAgB;;IAChB,0CAAuB;;IACvB,4CAAyB;;IACzB,qCAAkB;;IAClB,uCAAoB;;IACpB,kCAAe;;IAEf,4CAAyB;;IAEzB,yCAAoB;;IACpB,0CAAmB;;IACnB,uCAAgB;;IAChB,6CAA0B;;IAE1B,mDAA6B;;IAC7B,4CAA+B;;IAC/B,kDAA4B;;IAC5B,yCAAsB;;IAEtB,uCAA0B;;IAC1B,sCAAyB;;IACzB,6CAAgC;;IAChC,6CAAgC;;IAChC,sCAAyB;;IACzB,uCAA0B;;IAC1B,oCAAuB;;IACvB,sCAAyB;;IACzB,mCAAsB;;IACtB,oCAAuB;;IACvB,yCAA4B;;IAC5B,2CAA8B;;IAC9B,oCAAuB;;IAEvB,0CAAiD;;IAEjD,uCAA0B;;;;;IAEd,+BAAyB;;;;;IAAE,+BAA8B","sourcesContent":["import {\n  Directive,\n  OnInit,\n  OnDestroy,\n  Input,\n  ChangeDetectorRef,\n} from '@angular/core';\nimport {\n  Observable,\n  Subscription,\n  Subject,\n  fromEvent,\n  timer,\n  combineLatest,\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport {\n  IPlayable,\n  IMediaSubscriptions,\n} from '../../interfaces/vg-media-api.interface';\nimport { IMediaElement } from '../../interfaces/i-media-element.interface';\nimport { VgApiService } from '../../services/vg-api/vg-api.service';\nimport { VgStates } from '../../services/states/vg-states.service';\nimport { VgEvents } from '../../services/events/vg-events.service';\n\n@Directive({\n  selector: '[vgMedia]',\n})\nexport class VgMediaDirective implements OnInit, OnDestroy, IPlayable {\n  elem: any;\n\n  @Input() vgMedia: IMediaElement;\n  @Input() vgMaster: boolean;\n\n  state: string = VgStates.VG_PAUSED;\n\n  time: any = { current: 0, total: 0, left: 0 };\n  buffer: any = { end: 0 };\n  track: any;\n  subscriptions: IMediaSubscriptions | any;\n\n  canPlay = false;\n  canPlayThrough = false;\n  isMetadataLoaded = false;\n  isWaiting = false;\n  isCompleted = false;\n  isLive = false;\n\n  isBufferDetected = false;\n\n  checkInterval = 200;\n  currentPlayPos = 0;\n  lastPlayPos = 0;\n  specifiedDuration: number;\n\n  checkBufferSubscription: any;\n  syncSubscription: Subscription;\n  canPlayAllSubscription: any;\n  playAtferSync = false;\n\n  mutationObs: Subscription;\n  canPlayObs: Subscription;\n  canPlayThroughObs: Subscription;\n  loadedMetadataObs: Subscription;\n  waitingObs: Subscription;\n  progressObs: Subscription;\n  endedObs: Subscription;\n  playingObs: Subscription;\n  playObs: Subscription;\n  pauseObs: Subscription;\n  timeUpdateObs: Subscription;\n  volumeChangeObs: Subscription;\n  errorObs: Subscription;\n\n  bufferDetected: Subject<boolean> = new Subject();\n\n  playPromise: Promise<any>;\n\n  constructor(private api: VgApiService, private ref: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    if (this.vgMedia.nodeName) {\n      // It's a native element\n      this.elem = this.vgMedia;\n    } else {\n      // It's an Angular Class\n      this.elem = this.vgMedia.elem;\n    }\n\n    // Just in case we're creating this vgMedia dynamically register again into API\n    this.api.registerMedia(this);\n\n    this.subscriptions = {\n      // Native events\n      abort: fromEvent(this.elem as any, VgEvents.VG_ABORT),\n      canPlay: fromEvent(this.elem as any, VgEvents.VG_CAN_PLAY),\n      canPlayThrough: fromEvent(this.elem as any, VgEvents.VG_CAN_PLAY_THROUGH),\n      durationChange: fromEvent(this.elem as any, VgEvents.VG_DURATION_CHANGE),\n      emptied: fromEvent(this.elem as any, VgEvents.VG_EMPTIED),\n      encrypted: fromEvent(this.elem as any, VgEvents.VG_ENCRYPTED),\n      ended: fromEvent(this.elem as any, VgEvents.VG_ENDED),\n      error: fromEvent(this.elem as any, VgEvents.VG_ERROR),\n      loadedData: fromEvent(this.elem as any, VgEvents.VG_LOADED_DATA),\n      loadedMetadata: fromEvent(this.elem as any, VgEvents.VG_LOADED_METADATA),\n      loadStart: fromEvent(this.elem as any, VgEvents.VG_LOAD_START),\n      pause: fromEvent(this.elem as any, VgEvents.VG_PAUSE),\n      play: fromEvent(this.elem as any, VgEvents.VG_PLAY),\n      playing: fromEvent(this.elem as any, VgEvents.VG_PLAYING),\n      progress: fromEvent(this.elem as any, VgEvents.VG_PROGRESS),\n      rateChange: fromEvent(this.elem as any, VgEvents.VG_RATE_CHANGE),\n      seeked: fromEvent(this.elem as any, VgEvents.VG_SEEKED),\n      seeking: fromEvent(this.elem as any, VgEvents.VG_SEEKING),\n      stalled: fromEvent(this.elem as any, VgEvents.VG_STALLED),\n      suspend: fromEvent(this.elem as any, VgEvents.VG_SUSPEND),\n      timeUpdate: fromEvent(this.elem as any, VgEvents.VG_TIME_UPDATE),\n      volumeChange: fromEvent(this.elem as any, VgEvents.VG_VOLUME_CHANGE),\n      waiting: fromEvent(this.elem as any, VgEvents.VG_WAITING),\n\n      // Advertisement only events\n      startAds: fromEvent(window as any, VgEvents.VG_START_ADS),\n      endAds: fromEvent(window as any, VgEvents.VG_END_ADS),\n\n      // See changes on <source> child elements to reload the video file\n      mutation: new Observable((observer: any) => {\n        const domObs = new MutationObserver((mutations) => {\n          observer.next(mutations);\n        });\n\n        domObs.observe(this.elem as any, { childList: true, attributes: true });\n\n        return () => {\n          domObs.disconnect();\n        };\n      }),\n\n      // Custom buffering detection\n      bufferDetected: this.bufferDetected,\n    };\n\n    this.mutationObs = this.subscriptions.mutation.subscribe(\n      this.onMutation.bind(this)\n    );\n    this.canPlayObs = this.subscriptions.canPlay.subscribe(\n      this.onCanPlay.bind(this)\n    );\n    this.canPlayThroughObs = this.subscriptions.canPlayThrough.subscribe(\n      this.onCanPlayThrough.bind(this)\n    );\n    this.loadedMetadataObs = this.subscriptions.loadedMetadata.subscribe(\n      this.onLoadMetadata.bind(this)\n    );\n    this.waitingObs = this.subscriptions.waiting.subscribe(\n      this.onWait.bind(this)\n    );\n    this.progressObs = this.subscriptions.progress.subscribe(\n      this.onProgress.bind(this)\n    );\n    this.endedObs = this.subscriptions.ended.subscribe(\n      this.onComplete.bind(this)\n    );\n    this.playingObs = this.subscriptions.playing.subscribe(\n      this.onStartPlaying.bind(this)\n    );\n    this.playObs = this.subscriptions.play.subscribe(this.onPlay.bind(this));\n    this.pauseObs = this.subscriptions.pause.subscribe(this.onPause.bind(this));\n    this.timeUpdateObs = this.subscriptions.timeUpdate.subscribe(\n      this.onTimeUpdate.bind(this)\n    );\n    this.volumeChangeObs = this.subscriptions.volumeChange.subscribe(\n      this.onVolumeChange.bind(this)\n    );\n    this.errorObs = this.subscriptions.error.subscribe(this.onError.bind(this));\n\n    if (this.vgMaster) {\n      this.api.playerReadyEvent.subscribe(() => {\n        this.prepareSync();\n      });\n    }\n  }\n\n  prepareSync() {\n    const canPlayAll: Observable<any>[] = [];\n\n    for (const media in this.api.medias) {\n      if (this.api.medias[media]) {\n        canPlayAll.push(this.api.medias[media].subscriptions.canPlay);\n      }\n    }\n\n    this.canPlayAllSubscription = combineLatest(canPlayAll)\n      .pipe(map((...params) => {\n        const checkReadyState = (event) => {\n          if (!event?.target) {\n            return false;\n          }\n\n          return event.target.readyState === 4;\n        };\n\n        const allReady: boolean = params.some(checkReadyState);\n\n        if (allReady && !this.syncSubscription) {\n          this.startSync();\n          this.syncSubscription.unsubscribe();\n        }\n      }))\n      .subscribe();\n  }\n\n  startSync() {\n    this.syncSubscription = timer(0, 1000).subscribe(() => {\n      for (const media in this.api.medias) {\n        if (this.api.medias[media] !== this) {\n          const diff: number =\n            this.api.medias[media].currentTime - this.currentTime;\n\n          if (diff < -0.3 || diff > 0.3) {\n            this.playAtferSync = this.state === VgStates.VG_PLAYING;\n\n            this.pause();\n            this.api.medias[media].pause();\n            this.api.medias[media].currentTime = this.currentTime;\n          } else {\n            if (this.playAtferSync) {\n              this.play();\n              this.api.medias[media].play();\n              this.playAtferSync = false;\n            }\n          }\n        }\n      }\n    });\n  }\n\n  onMutation(mutations: Array<MutationRecord>) {\n    // Detect changes only for source elements or src attribute\n    for (let i = 0, l = mutations.length; i < l; i++) {\n      const mut: MutationRecord = mutations[i];\n\n      if (mut.type === 'attributes' && mut.attributeName === 'src') {\n        // Only load src file if it's not a blob (for DASH / HLS sources)\n        if (\n          (mut.target as any).src &&\n          (mut.target as any).src.length > 0 &&\n          (mut.target as any).src.indexOf('blob:') < 0\n        ) {\n          this.loadMedia();\n          break;\n        }\n      } else if (\n        mut.type === 'childList' &&\n        mut.removedNodes.length &&\n        mut.removedNodes[0].nodeName.toLowerCase() === 'source'\n      ) {\n        this.loadMedia();\n        break;\n      }\n    }\n  }\n\n  loadMedia() {\n    this.vgMedia.pause();\n    this.vgMedia.currentTime = 0;\n\n    // Start buffering until we can play the media file\n    this.stopBufferCheck();\n    this.isBufferDetected = true;\n    this.bufferDetected.next(this.isBufferDetected);\n\n    // TODO: This is ugly, we should find something cleaner. For some reason a TimerObservable doesn't works.\n    setTimeout(() => this.vgMedia.load(), 10);\n  }\n\n  play() {\n    // short-circuit if already playing\n    if (\n      this.playPromise ||\n      (this.state !== VgStates.VG_PAUSED && this.state !== VgStates.VG_ENDED)\n    ) {\n      return;\n    }\n\n    this.playPromise = this.vgMedia.play();\n\n    // browser has async play promise\n    if (this.playPromise && this.playPromise.then && this.playPromise.catch) {\n      this.playPromise\n        .then(() => {\n          this.playPromise = null;\n        })\n        .catch(() => {\n          this.playPromise = null;\n          // deliberately empty for the sake of eating console noise\n        });\n    }\n\n    return this.playPromise;\n  }\n\n  pause() {\n    // browser has async play promise\n    if (this.playPromise) {\n      this.playPromise.then(() => {\n        this.vgMedia.pause();\n      });\n    } else {\n      this.vgMedia.pause();\n    }\n  }\n\n  get id() {\n    // We should return undefined if vgMedia still doesn't exist\n    let result: any;\n\n    if (this.vgMedia) {\n      result = this.vgMedia.id;\n    }\n\n    return result;\n  }\n\n  get duration() {\n    return this.vgMedia.duration === Infinity\n      ? this.specifiedDuration\n      : this.vgMedia.duration;\n  }\n\n  set currentTime(seconds) {\n    this.vgMedia.currentTime = seconds;\n    // this.elem.dispatchEvent(new CustomEvent(VgEvents.VG_SEEK));\n  }\n\n  get currentTime() {\n    return this.vgMedia.currentTime;\n  }\n\n  set volume(volume) {\n    this.vgMedia.volume = volume;\n  }\n\n  get volume() {\n    return this.vgMedia.volume;\n  }\n\n  set playbackRate(rate) {\n    this.vgMedia.playbackRate = rate;\n  }\n\n  get playbackRate() {\n    return this.vgMedia.playbackRate;\n  }\n\n  get buffered() {\n    return this.vgMedia.buffered;\n  }\n\n  get textTracks() {\n    return this.vgMedia.textTracks;\n  }\n  // @ts-ignore\n  onCanPlay(event: any) {\n    this.isBufferDetected = false;\n    this.bufferDetected.next(this.isBufferDetected);\n    this.canPlay = true;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onCanPlayThrough(event: any) {\n    this.isBufferDetected = false;\n    this.bufferDetected.next(this.isBufferDetected);\n    this.canPlayThrough = true;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onLoadMetadata(event: any) {\n    this.isMetadataLoaded = true;\n\n    this.time = {\n      current: 0,\n      left: 0,\n      total: this.duration * 1000,\n    };\n\n    this.state = VgStates.VG_PAUSED;\n\n    // Live streaming check\n    const t: number = Math.round(this.time.total);\n    this.isLive = t === Infinity;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onWait(event: any) {\n    this.isWaiting = true;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onComplete(event: any) {\n    this.isCompleted = true;\n    this.state = VgStates.VG_ENDED;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onStartPlaying(event: any) {\n    this.state = VgStates.VG_PLAYING;\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onPlay(event: any) {\n    this.state = VgStates.VG_PLAYING;\n\n    if (this.vgMaster) {\n      if (!this.syncSubscription || this.syncSubscription.closed) {\n        this.startSync();\n      }\n    }\n\n    this.startBufferCheck();\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onPause(event: any) {\n    this.state = VgStates.VG_PAUSED;\n\n    if (this.vgMaster) {\n      if (!this.playAtferSync) {\n        this.syncSubscription.unsubscribe();\n      }\n    }\n\n    this.stopBufferCheck();\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onTimeUpdate(event: any) {\n    const end = this.buffered.length - 1;\n\n    this.time = {\n      current: this.currentTime * 1000,\n      total: this.time.total,\n      left: (this.duration - this.currentTime) * 1000,\n    };\n\n    if (end >= 0) {\n      this.buffer = { end: this.buffered.end(end) * 1000 };\n    }\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onProgress(event: any) {\n    const end = this.buffered.length - 1;\n\n    if (end >= 0) {\n      this.buffer = { end: this.buffered.end(end) * 1000 };\n    }\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onVolumeChange(event: any) {\n    // TODO: Save to localstorage the current volume\n    this.ref.detectChanges();\n  }\n  // @ts-ignore\n  onError(event: any) {\n    // TODO: Handle error messages\n    this.ref.detectChanges();\n  }\n\n  // http://stackoverflow.com/a/23828241/779529\n  bufferCheck() {\n    const offset = 1 / this.checkInterval;\n    this.currentPlayPos = this.currentTime;\n\n    if (\n      !this.isBufferDetected &&\n      this.currentPlayPos < this.lastPlayPos + offset\n    ) {\n      this.isBufferDetected = true;\n    }\n\n    if (\n      this.isBufferDetected &&\n      this.currentPlayPos > this.lastPlayPos + offset\n    ) {\n      this.isBufferDetected = false;\n    }\n\n    // Prevent calls to bufferCheck after ngOnDestroy have been called\n    if (!this.bufferDetected.closed) {\n      this.bufferDetected.next(this.isBufferDetected);\n    }\n\n    this.lastPlayPos = this.currentPlayPos;\n  }\n\n  startBufferCheck() {\n    this.checkBufferSubscription = timer(0, this.checkInterval).subscribe(\n      () => {\n        this.bufferCheck();\n      }\n    );\n  }\n\n  stopBufferCheck() {\n    if (this.checkBufferSubscription) {\n      this.checkBufferSubscription.unsubscribe();\n    }\n\n    this.isBufferDetected = false;\n\n    this.bufferDetected.next(this.isBufferDetected);\n  }\n\n  seekTime(value: number, byPercent: boolean = false) {\n    let second: number;\n    const duration: number = this.duration;\n\n    if (byPercent) {\n      second = (value * duration) / 100;\n    } else {\n      second = value;\n    }\n\n    this.currentTime = second;\n  }\n\n  addTextTrack(\n    type: string,\n    label?: string,\n    language?: string,\n    mode?: 'disabled' | 'hidden' | 'showing'\n  ): TextTrack {\n    const newTrack: TextTrack = this.vgMedia.addTextTrack(\n      type,\n      label,\n      language\n    );\n\n    if (mode) {\n      newTrack.mode = mode;\n    }\n    return newTrack;\n  }\n\n  ngOnDestroy() {\n    this.vgMedia.src = '';\n    this.mutationObs.unsubscribe();\n    this.canPlayObs.unsubscribe();\n    this.canPlayThroughObs.unsubscribe();\n    this.loadedMetadataObs.unsubscribe();\n    this.waitingObs.unsubscribe();\n    this.progressObs.unsubscribe();\n    this.endedObs.unsubscribe();\n    this.playingObs.unsubscribe();\n    this.playObs.unsubscribe();\n    this.pauseObs.unsubscribe();\n    this.timeUpdateObs.unsubscribe();\n    this.volumeChangeObs.unsubscribe();\n    this.errorObs.unsubscribe();\n\n    if (this.checkBufferSubscription) {\n      this.checkBufferSubscription.unsubscribe();\n    }\n\n    if (this.syncSubscription) {\n      this.syncSubscription.unsubscribe();\n    }\n\n    this.bufferDetected.complete();\n    this.bufferDetected.unsubscribe();\n\n    this.api.unregisterMedia(this);\n  }\n}\n"]}
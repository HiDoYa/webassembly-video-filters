!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@videogular/ngx-videogular/core",["exports","@angular/core","@angular/common","rxjs","rxjs/operators"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).videogular=e.videogular||{},e.videogular["ngx-videogular"]=e.videogular["ngx-videogular"]||{},e.videogular["ngx-videogular"].core={}),e.ng.core,e.ng.common,e.rxjs,e.rxjs.operators)}(this,(function(e,t,i,n,r){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;function s(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}Object.create;var a=function(){};a.VG_ENDED="ended",a.VG_PAUSED="paused",a.VG_PLAYING="playing",a.VG_LOADING="waiting",a.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],a.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new a},token:a,providedIn:"root"});var u=function(){function e(){this.medias={},this.playerReadyEvent=new t.EventEmitter(!0),this.isPlayerReady=!1}return e.prototype.onPlayerReady=function(e){this.fsAPI=e,this.isPlayerReady=!0,this.playerReadyEvent.emit(this)},e.prototype.getDefaultMedia=function(){for(var e in this.medias)if(this.medias[e])return this.medias[e]},e.prototype.getMasterMedia=function(){var e;for(var t in this.medias)if("true"===this.medias[t].vgMaster||!0===this.medias[t].vgMaster){e=this.medias[t];break}return e||this.getDefaultMedia()},e.prototype.isMasterDefined=function(){var e=!1;for(var t in this.medias)if("true"===this.medias[t].vgMaster||!0===this.medias[t].vgMaster){e=!0;break}return e},e.prototype.getMediaById=function(e){void 0===e&&(e=null);var t=this.medias[e];return e&&"*"!==e||(t=this),t},e.prototype.play=function(){for(var e in this.medias)this.medias[e]&&this.medias[e].play()},e.prototype.pause=function(){for(var e in this.medias)this.medias[e]&&this.medias[e].pause()},Object.defineProperty(e.prototype,"duration",{get:function(){return this.$$getAllProperties("duration")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.$$getAllProperties("currentTime")},set:function(e){this.$$setAllProperties("currentTime",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this.$$getAllProperties("state")},set:function(e){this.$$setAllProperties("state",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.$$getAllProperties("volume")},set:function(e){this.$$setAllProperties("volume",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.$$getAllProperties("playbackRate")},set:function(e){this.$$setAllProperties("playbackRate",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canPlay",{get:function(){return this.$$getAllProperties("canPlay")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canPlayThrough",{get:function(){return this.$$getAllProperties("canPlayThrough")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMetadataLoaded",{get:function(){return this.$$getAllProperties("isMetadataLoaded")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWaiting",{get:function(){return this.$$getAllProperties("isWaiting")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCompleted",{get:function(){return this.$$getAllProperties("isCompleted")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.$$getAllProperties("isLive")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMaster",{get:function(){return this.$$getAllProperties("isMaster")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.$$getAllProperties("time")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this.$$getAllProperties("buffer")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.$$getAllProperties("buffered")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this.$$getAllProperties("subscriptions")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.$$getAllProperties("textTracks")},enumerable:!1,configurable:!0}),e.prototype.seekTime=function(e,t){for(var i in void 0===t&&(t=!1),this.medias)this.medias[i]&&this.$$seek(this.medias[i],e,t)},e.prototype.$$seek=function(e,t,i){var n;void 0===i&&(i=!1);var r=e.duration;i?(this.isMasterDefined()&&(r=this.getMasterMedia().duration),n=t*r/100):n=t,e.currentTime=n},e.prototype.addTextTrack=function(e,t,i){for(var n in this.medias)this.medias[n]&&this.$$addTextTrack(this.medias[n],e,t,i)},e.prototype.$$addTextTrack=function(e,t,i,n){e.addTextTrack(t,i,n)},e.prototype.$$getAllProperties=function(e){var t,i={};for(var n in this.medias)this.medias[n]&&(i[n]=this.medias[n]);switch(Object.keys(i).length){case 0:switch(e){case"state":t=a.VG_PAUSED;break;case"playbackRate":case"volume":t=1;break;case"time":t={current:0,total:0,left:0}}break;case 1:t=i[Object.keys(i)[0]][e];break;default:t=i[this.getMasterMedia().id][e]}return t},e.prototype.$$setAllProperties=function(e,t){for(var i in this.medias)this.medias[i]&&(this.medias[i][e]=t)},e.prototype.registerElement=function(e){this.videogularElement=e},e.prototype.registerMedia=function(e){this.medias[e.id]=e},e.prototype.unregisterMedia=function(e){delete this.medias[e.id]},e}();u.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],u.ctorParameters=function(){return[]},u.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new u},token:u,providedIn:"root"});var c=function(){function e(){this.isHiddenSubject=new n.Subject,this.isHidden=this.isHiddenSubject.asObservable()}return e.prototype.state=function(e){this.isHiddenSubject.next(e)},e}();c.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],c.ctorParameters=function(){return[]},c.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new c},token:c,providedIn:"root"});var l=function(){function e(){}return e.getZIndex=function(){for(var e,t=1,i=document.getElementsByTagName("*"),n=0,r=i.length;n<r;n++)(e=parseInt(window.getComputedStyle(i[n])["z-index"],10))>t&&(t=e+1);return t},e.isMobileDevice=function(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},e.isiOSDevice=function(){return navigator.userAgent.match(/ip(hone|ad|od)/i)&&!navigator.userAgent.match(/(iemobile)[\/\s]?([\w\.]*)/i)},e.isCordova=function(){return-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")},e}();l.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],l.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new l},token:l,providedIn:"root"});var h=function(){function e(){this.nativeFullscreen=!0,this.isFullscreen=!1,this.onChangeFullscreen=new t.EventEmitter}return e.prototype.init=function(e,t){var i=this;this.videogularElement=e,this.medias=t;var r={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",onchange:"fullscreenchange",onerror:"fullscreenerror"},newWebkit:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},oldWebkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",onchange:"mozfullscreenchange",onerror:"mozfullscreenerror"},ios:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",onchange:"webkitendfullscreen",onerror:"webkitfullscreenerror"},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",onchange:"MSFullscreenChange",onerror:"MSFullscreenError"}};for(var s in r)if(r[s].enabled in document){this.polyfill=r[s];break}if(l.isiOSDevice()&&(this.polyfill=r.ios),this.isAvailable=null!=this.polyfill,null!=this.polyfill){var o;switch(this.polyfill.onchange){case"mozfullscreenchange":o=document;break;case"webkitendfullscreen":o=this.medias.toArray()[0].elem;break;default:o=e}this.fsChangeSubscription=n.fromEvent(o,this.polyfill.onchange).subscribe((function(){i.onFullscreenChange()}))}},e.prototype.onFullscreenChange=function(){this.isFullscreen=!!document[this.polyfill.element],this.onChangeFullscreen.emit(this.isFullscreen)},e.prototype.toggleFullscreen=function(e){void 0===e&&(e=null),this.isFullscreen?this.exit():this.request(e)},e.prototype.request=function(e){e||(e=this.videogularElement),this.isFullscreen=!0,this.onChangeFullscreen.emit(!0),this.isAvailable&&this.nativeFullscreen&&(l.isMobileDevice()?((!this.polyfill.enabled&&e===this.videogularElement||l.isiOSDevice())&&(e=this.medias.toArray()[0].elem),this.enterElementInFullScreen(e)):this.enterElementInFullScreen(this.videogularElement))},e.prototype.enterElementInFullScreen=function(e){e[this.polyfill.request]()},e.prototype.exit=function(){this.isFullscreen=!1,this.onChangeFullscreen.emit(!1),this.isAvailable&&this.nativeFullscreen&&document[this.polyfill.exit]()},e}();h.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],h.ctorParameters=function(){return[]},h.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new h},token:h,providedIn:"root"});var p=function(){};p.VG_ABORT="abort",p.VG_CAN_PLAY="canplay",p.VG_CAN_PLAY_THROUGH="canplaythrough",p.VG_DURATION_CHANGE="durationchange",p.VG_EMPTIED="emptied",p.VG_ENCRYPTED="encrypted",p.VG_ENDED="ended",p.VG_ERROR="error",p.VG_LOADED_DATA="loadeddata",p.VG_LOADED_METADATA="loadedmetadata",p.VG_LOAD_START="loadstart",p.VG_PAUSE="pause",p.VG_PLAY="play",p.VG_PLAYING="playing",p.VG_PROGRESS="progress",p.VG_RATE_CHANGE="ratechange",p.VG_SEEK="seek",p.VG_SEEKED="seeked",p.VG_SEEKING="seeking",p.VG_STALLED="stalled",p.VG_SUSPEND="suspend",p.VG_TIME_UPDATE="timeupdate",p.VG_VOLUME_CHANGE="volumechange",p.VG_WAITING="waiting",p.VG_LOAD="load",p.VG_ENTER="enter",p.VG_EXIT="exit",p.VG_START_ADS="startads",p.VG_END_ADS="endads",p.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],p.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new p},token:p,providedIn:"root"});var d=function(){function e(e){this.ref=e,this.onEnterCuePoint=new t.EventEmitter,this.onUpdateCuePoint=new t.EventEmitter,this.onExitCuePoint=new t.EventEmitter,this.onCompleteCuePoint=new t.EventEmitter,this.subscriptions=[],this.cuesSubscriptions=[],this.totalCues=0}return e.prototype.ngOnInit=function(){this.onLoad$=n.fromEvent(this.ref.nativeElement,p.VG_LOAD),this.subscriptions.push(this.onLoad$.subscribe(this.onLoad.bind(this)))},e.prototype.onLoad=function(e){var t=e.target.track.cues;this.ref.nativeElement.cues=t,this.updateCuePoints(t)},e.prototype.updateCuePoints=function(e){this.cuesSubscriptions.forEach((function(e){return e.unsubscribe()}));for(var t=0,i=e.length;t<i;t++)this.onEnter$=n.fromEvent(e[t],p.VG_ENTER),this.cuesSubscriptions.push(this.onEnter$.subscribe(this.onEnter.bind(this))),this.onExit$=n.fromEvent(e[t],p.VG_EXIT),this.cuesSubscriptions.push(this.onExit$.subscribe(this.onExit.bind(this)))},e.prototype.onEnter=function(e){this.onEnterCuePoint.emit(e.target)},e.prototype.onExit=function(e){this.onExitCuePoint.emit(e.target)},e.prototype.ngDoCheck=function(){this.ref.nativeElement.track&&this.ref.nativeElement.track.cues&&(this.totalCues!==this.ref.nativeElement.track.cues.length&&(this.totalCues=this.ref.nativeElement.track.cues.length,this.ref.nativeElement.cues=this.ref.nativeElement.track.cues,this.updateCuePoints(this.ref.nativeElement.track.cues)))},e.prototype.ngOnDestroy=function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))},e}();d.decorators=[{type:t.Directive,args:[{selector:"[vgCuePoints]"}]}],d.ctorParameters=function(){return[{type:t.ElementRef}]},d.propDecorators={onEnterCuePoint:[{type:t.Output}],onUpdateCuePoint:[{type:t.Output}],onExitCuePoint:[{type:t.Output}],onCompleteCuePoint:[{type:t.Output}]};var f=function(){function e(e,t){this.api=e,this.ref=t,this.state=a.VG_PAUSED,this.time={current:0,total:0,left:0},this.buffer={end:0},this.canPlay=!1,this.canPlayThrough=!1,this.isMetadataLoaded=!1,this.isWaiting=!1,this.isCompleted=!1,this.isLive=!1,this.isBufferDetected=!1,this.checkInterval=200,this.currentPlayPos=0,this.lastPlayPos=0,this.playAtferSync=!1,this.bufferDetected=new n.Subject}return e.prototype.ngOnInit=function(){var e=this;this.vgMedia.nodeName?this.elem=this.vgMedia:this.elem=this.vgMedia.elem,this.api.registerMedia(this),this.subscriptions={abort:n.fromEvent(this.elem,p.VG_ABORT),canPlay:n.fromEvent(this.elem,p.VG_CAN_PLAY),canPlayThrough:n.fromEvent(this.elem,p.VG_CAN_PLAY_THROUGH),durationChange:n.fromEvent(this.elem,p.VG_DURATION_CHANGE),emptied:n.fromEvent(this.elem,p.VG_EMPTIED),encrypted:n.fromEvent(this.elem,p.VG_ENCRYPTED),ended:n.fromEvent(this.elem,p.VG_ENDED),error:n.fromEvent(this.elem,p.VG_ERROR),loadedData:n.fromEvent(this.elem,p.VG_LOADED_DATA),loadedMetadata:n.fromEvent(this.elem,p.VG_LOADED_METADATA),loadStart:n.fromEvent(this.elem,p.VG_LOAD_START),pause:n.fromEvent(this.elem,p.VG_PAUSE),play:n.fromEvent(this.elem,p.VG_PLAY),playing:n.fromEvent(this.elem,p.VG_PLAYING),progress:n.fromEvent(this.elem,p.VG_PROGRESS),rateChange:n.fromEvent(this.elem,p.VG_RATE_CHANGE),seeked:n.fromEvent(this.elem,p.VG_SEEKED),seeking:n.fromEvent(this.elem,p.VG_SEEKING),stalled:n.fromEvent(this.elem,p.VG_STALLED),suspend:n.fromEvent(this.elem,p.VG_SUSPEND),timeUpdate:n.fromEvent(this.elem,p.VG_TIME_UPDATE),volumeChange:n.fromEvent(this.elem,p.VG_VOLUME_CHANGE),waiting:n.fromEvent(this.elem,p.VG_WAITING),startAds:n.fromEvent(window,p.VG_START_ADS),endAds:n.fromEvent(window,p.VG_END_ADS),mutation:new n.Observable((function(t){var i=new MutationObserver((function(e){t.next(e)}));return i.observe(e.elem,{childList:!0,attributes:!0}),function(){i.disconnect()}})),bufferDetected:this.bufferDetected},this.mutationObs=this.subscriptions.mutation.subscribe(this.onMutation.bind(this)),this.canPlayObs=this.subscriptions.canPlay.subscribe(this.onCanPlay.bind(this)),this.canPlayThroughObs=this.subscriptions.canPlayThrough.subscribe(this.onCanPlayThrough.bind(this)),this.loadedMetadataObs=this.subscriptions.loadedMetadata.subscribe(this.onLoadMetadata.bind(this)),this.waitingObs=this.subscriptions.waiting.subscribe(this.onWait.bind(this)),this.progressObs=this.subscriptions.progress.subscribe(this.onProgress.bind(this)),this.endedObs=this.subscriptions.ended.subscribe(this.onComplete.bind(this)),this.playingObs=this.subscriptions.playing.subscribe(this.onStartPlaying.bind(this)),this.playObs=this.subscriptions.play.subscribe(this.onPlay.bind(this)),this.pauseObs=this.subscriptions.pause.subscribe(this.onPause.bind(this)),this.timeUpdateObs=this.subscriptions.timeUpdate.subscribe(this.onTimeUpdate.bind(this)),this.volumeChangeObs=this.subscriptions.volumeChange.subscribe(this.onVolumeChange.bind(this)),this.errorObs=this.subscriptions.error.subscribe(this.onError.bind(this)),this.vgMaster&&this.api.playerReadyEvent.subscribe((function(){e.prepareSync()}))},e.prototype.prepareSync=function(){var e=this,t=[];for(var i in this.api.medias)this.api.medias[i]&&t.push(this.api.medias[i].subscriptions.canPlay);this.canPlayAllSubscription=n.combineLatest(t).pipe(r.map((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=function(e){return!!(null==e?void 0:e.target)&&4===e.target.readyState},r=t.some(n);r&&!e.syncSubscription&&(e.startSync(),e.syncSubscription.unsubscribe())}))).subscribe()},e.prototype.startSync=function(){var e=this;this.syncSubscription=n.timer(0,1e3).subscribe((function(){for(var t in e.api.medias)if(e.api.medias[t]!==e){var i=e.api.medias[t].currentTime-e.currentTime;i<-.3||i>.3?(e.playAtferSync=e.state===a.VG_PLAYING,e.pause(),e.api.medias[t].pause(),e.api.medias[t].currentTime=e.currentTime):e.playAtferSync&&(e.play(),e.api.medias[t].play(),e.playAtferSync=!1)}}))},e.prototype.onMutation=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];if("attributes"===n.type&&"src"===n.attributeName){if(n.target.src&&n.target.src.length>0&&n.target.src.indexOf("blob:")<0){this.loadMedia();break}}else if("childList"===n.type&&n.removedNodes.length&&"source"===n.removedNodes[0].nodeName.toLowerCase()){this.loadMedia();break}}},e.prototype.loadMedia=function(){var e=this;this.vgMedia.pause(),this.vgMedia.currentTime=0,this.stopBufferCheck(),this.isBufferDetected=!0,this.bufferDetected.next(this.isBufferDetected),setTimeout((function(){return e.vgMedia.load()}),10)},e.prototype.play=function(){var e=this;if(!(this.playPromise||this.state!==a.VG_PAUSED&&this.state!==a.VG_ENDED))return this.playPromise=this.vgMedia.play(),this.playPromise&&this.playPromise.then&&this.playPromise.catch&&this.playPromise.then((function(){e.playPromise=null})).catch((function(){e.playPromise=null})),this.playPromise},e.prototype.pause=function(){var e=this;this.playPromise?this.playPromise.then((function(){e.vgMedia.pause()})):this.vgMedia.pause()},Object.defineProperty(e.prototype,"id",{get:function(){var e;return this.vgMedia&&(e=this.vgMedia.id),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.vgMedia.duration===1/0?this.specifiedDuration:this.vgMedia.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.vgMedia.currentTime},set:function(e){this.vgMedia.currentTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.vgMedia.volume},set:function(e){this.vgMedia.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.vgMedia.playbackRate},set:function(e){this.vgMedia.playbackRate=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.vgMedia.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.vgMedia.textTracks},enumerable:!1,configurable:!0}),e.prototype.onCanPlay=function(e){this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected),this.canPlay=!0,this.ref.detectChanges()},e.prototype.onCanPlayThrough=function(e){this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected),this.canPlayThrough=!0,this.ref.detectChanges()},e.prototype.onLoadMetadata=function(e){this.isMetadataLoaded=!0,this.time={current:0,left:0,total:1e3*this.duration},this.state=a.VG_PAUSED;var t=Math.round(this.time.total);this.isLive=t===1/0,this.ref.detectChanges()},e.prototype.onWait=function(e){this.isWaiting=!0,this.ref.detectChanges()},e.prototype.onComplete=function(e){this.isCompleted=!0,this.state=a.VG_ENDED,this.ref.detectChanges()},e.prototype.onStartPlaying=function(e){this.state=a.VG_PLAYING,this.ref.detectChanges()},e.prototype.onPlay=function(e){this.state=a.VG_PLAYING,this.vgMaster&&(this.syncSubscription&&!this.syncSubscription.closed||this.startSync()),this.startBufferCheck(),this.ref.detectChanges()},e.prototype.onPause=function(e){this.state=a.VG_PAUSED,this.vgMaster&&(this.playAtferSync||this.syncSubscription.unsubscribe()),this.stopBufferCheck(),this.ref.detectChanges()},e.prototype.onTimeUpdate=function(e){var t=this.buffered.length-1;this.time={current:1e3*this.currentTime,total:this.time.total,left:1e3*(this.duration-this.currentTime)},t>=0&&(this.buffer={end:1e3*this.buffered.end(t)}),this.ref.detectChanges()},e.prototype.onProgress=function(e){var t=this.buffered.length-1;t>=0&&(this.buffer={end:1e3*this.buffered.end(t)}),this.ref.detectChanges()},e.prototype.onVolumeChange=function(e){this.ref.detectChanges()},e.prototype.onError=function(e){this.ref.detectChanges()},e.prototype.bufferCheck=function(){var e=1/this.checkInterval;this.currentPlayPos=this.currentTime,!this.isBufferDetected&&this.currentPlayPos<this.lastPlayPos+e&&(this.isBufferDetected=!0),this.isBufferDetected&&this.currentPlayPos>this.lastPlayPos+e&&(this.isBufferDetected=!1),this.bufferDetected.closed||this.bufferDetected.next(this.isBufferDetected),this.lastPlayPos=this.currentPlayPos},e.prototype.startBufferCheck=function(){var e=this;this.checkBufferSubscription=n.timer(0,this.checkInterval).subscribe((function(){e.bufferCheck()}))},e.prototype.stopBufferCheck=function(){this.checkBufferSubscription&&this.checkBufferSubscription.unsubscribe(),this.isBufferDetected=!1,this.bufferDetected.next(this.isBufferDetected)},e.prototype.seekTime=function(e,t){var i;void 0===t&&(t=!1);var n=this.duration;i=t?e*n/100:e,this.currentTime=i},e.prototype.addTextTrack=function(e,t,i,n){var r=this.vgMedia.addTextTrack(e,t,i);return n&&(r.mode=n),r},e.prototype.ngOnDestroy=function(){this.vgMedia.src="",this.mutationObs.unsubscribe(),this.canPlayObs.unsubscribe(),this.canPlayThroughObs.unsubscribe(),this.loadedMetadataObs.unsubscribe(),this.waitingObs.unsubscribe(),this.progressObs.unsubscribe(),this.endedObs.unsubscribe(),this.playingObs.unsubscribe(),this.playObs.unsubscribe(),this.pauseObs.unsubscribe(),this.timeUpdateObs.unsubscribe(),this.volumeChangeObs.unsubscribe(),this.errorObs.unsubscribe(),this.checkBufferSubscription&&this.checkBufferSubscription.unsubscribe(),this.syncSubscription&&this.syncSubscription.unsubscribe(),this.bufferDetected.complete(),this.bufferDetected.unsubscribe(),this.api.unregisterMedia(this)},e}();f.decorators=[{type:t.Directive,args:[{selector:"[vgMedia]"}]}],f.ctorParameters=function(){return[{type:u},{type:t.ChangeDetectorRef}]},f.propDecorators={vgMedia:[{type:t.Input}],vgMaster:[{type:t.Input}]};var b=function(){function e(e,i,n,r){this.api=i,this.fsAPI=n,this.controlsHidden=r,this.isFullscreen=!1,this.isNativeFullscreen=!1,this.areControlsHidden=!1,this.onPlayerReady=new t.EventEmitter,this.onMediaReady=new t.EventEmitter,this.subscriptions=[],this.elem=e.nativeElement,this.api.registerElement(this.elem)}return e.prototype.ngAfterContentInit=function(){var e=this;this.medias.toArray().forEach((function(t){e.api.registerMedia(t)})),this.fsAPI.init(this.elem,this.medias),this.subscriptions.push(this.fsAPI.onChangeFullscreen.subscribe(this.onChangeFullscreen.bind(this))),this.subscriptions.push(this.controlsHidden.isHidden.subscribe(this.onHideControls.bind(this))),this.api.onPlayerReady(this.fsAPI),this.onPlayerReady.emit(this.api)},e.prototype.onChangeFullscreen=function(e){this.fsAPI.nativeFullscreen?this.isNativeFullscreen=e:(this.isFullscreen=e,this.zIndex=e?l.getZIndex().toString():"auto")},e.prototype.onHideControls=function(e){this.areControlsHidden=e},e.prototype.ngOnDestroy=function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))},e}();b.decorators=[{type:t.Component,args:[{selector:"vg-player",encapsulation:t.ViewEncapsulation.None,template:"<ng-content></ng-content>",providers:[u,h,c],styles:["\n      vg-player {\n        font-family: 'videogular';\n        position: relative;\n        display: flex;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        background-color: black;\n      }\n      vg-player.fullscreen {\n        position: fixed;\n        left: 0;\n        top: 0;\n      }\n      vg-player.native-fullscreen.controls-hidden {\n        cursor: none;\n      }\n    "]}]}],b.ctorParameters=function(){return[{type:t.ElementRef},{type:u},{type:h},{type:c}]},b.propDecorators={isFullscreen:[{type:t.HostBinding,args:["class.fullscreen"]}],isNativeFullscreen:[{type:t.HostBinding,args:["class.native-fullscreen"]}],areControlsHidden:[{type:t.HostBinding,args:["class.controls-hidden"]}],zIndex:[{type:t.HostBinding,args:["style.z-index"]}],onPlayerReady:[{type:t.Output}],onMediaReady:[{type:t.Output}],medias:[{type:t.ContentChildren,args:[f]}]};var y=[u,c,h,l,p,a],m=[d,f],g=function(){};g.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule],providers:o(y),declarations:o(m,[b]),exports:o(m,[b])}]}];var v=function(){function e(){}return Object.defineProperty(e.prototype,"audioTracks",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.addTextTrack=function(e,t,i){return null},e.prototype.canPlayType=function(e){return null},e.prototype.load=function(){},e.prototype.msClearEffects=function(){},e.prototype.msGetAsCastingSource=function(){return null},e.prototype.msInsertAudioEffect=function(e,t,i){},e.prototype.msSetMediaKeys=function(e){},e.prototype.msSetMediaProtectionManager=function(e){},e.prototype.pause=function(){},e.prototype.play=function(){return null},e.prototype.setMediaKeys=function(e){return null},e.prototype.addEventListener=function(e,t,i){},e}();e.VgApiService=u,e.VgControlsHiddenService=c,e.VgCoreModule=g,e.VgCuePointsDirective=d,e.VgEvents=p,e.VgFullscreenApiService=h,e.VgMediaDirective=f,e.VgMediaElement=v,e.VgPlayerComponent=b,e.VgStates=a,e.VgUtilsService=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=videogular-ngx-videogular-core.umd.min.js.map
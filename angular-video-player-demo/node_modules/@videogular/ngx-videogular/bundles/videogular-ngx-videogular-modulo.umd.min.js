!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@videogular/ngx-videogular/modulo",["exports","@angular/core","@angular/common"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).videogular=e.videogular||{},e.videogular["ngx-videogular"]=e.videogular["ngx-videogular"]||{},e.videogular["ngx-videogular"].modulo={}),e.ng.core,e.ng.common)}(this,(function(e,t,i){"use strict";var n=window.AudioContext||window.webkitAudioContext,a=function(){function e(t,i,a){if(!(this instanceof e))return new e(t,i,a);i instanceof n||(a=i,i=null),a=a||{},this.ctx=i=i||new n,t instanceof AudioNode||(t=t instanceof Audio||t instanceof HTMLAudioElement?i.createMediaElementSource(t):i.createMediaStreamSource(t)),this.audioConfigStateResolver(i,a,t),this.audioConfigStateParser(i)}return e.prototype.waveform=function(e,t){return e||(e=this.wavedata||(this.wavedata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount))),(this.stereo?this.analyser[t||0]:this.analyser).getByteTimeDomainData(e),e},e.prototype.frequencies=function(e,t){return e||(e=this.freqdata||(this.freqdata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount))),(this.stereo?this.analyser[t||0]:this.analyser).getByteFrequencyData(e),e},e.prototype.audioConfigStateResolver=function(e,t,i){this.analyser=e.createAnalyser(),this.stereo=!!t.stereo,this.audible=!1!==t.audible,this.wavedata=null,this.freqdata=null,this.splitter=null,this.merger=null,this.source=i},e.prototype.audioConfigStateParser=function(e){if(this.stereo){this.analyser=[this.analyser[0]||this.analyser],this.analyser.push(e.createAnalyser()),this.splitter=e.createChannelSplitter(2),this.merger=e.createChannelMerger(2),this.output=this.merger,this.source.connect(this.splitter);for(var t=0;t<2;t++)this.splitter.connect(this.analyser[t],t,0),this.analyser[t].connect(this.merger,0,t);this.audible&&this.merger.connect(e.destination)}else this.output=this.source,this.source.connect(this.analyser[0]||this.analyser),this.audible&&(this.analyser[0]||this.analyser).connect(e.destination)},e}();var o=function(){function e(){}return e.prototype.startVisualizer=function(){if(!this._audioAnalyser){this._audioAnalyser=new a(this.audioElement);var e=this.moduloConfig.dimensions,t=e.width,i=e.height,n=this.waveCanvas.nativeElement;this._ctx=n.getContext("2d"),n.width=t,n.height=i}this.update()},e.prototype.update=function(){var e=this,t=this._audioAnalyser.waveform(),i=this.moduloConfig,n=i.fillStyle,a=i.strokeStyle,o=i.lineWidth,s=i.scaleFactor,r=this.waveCanvas.nativeElement,l=r.width,u=r.height;this._ctx.fillStyle=n,this._ctx.fillRect(0,0,l,u),this._ctx.strokeStyle=a,this._ctx.lineWidth=o,this._ctx.beginPath(),this._ctx.moveTo(0,u/2-t[0]*s);for(var h=0;h<t.length;h++)this._ctx.lineTo(l/t.length*h,u/2-t[h]*s);this._ctx.moveTo(0,u/2+t[0]*s);for(h=0;h<t.length;h++)this._ctx.lineTo(l/t.length*h,u/2+t[h]*s);this._ctx.stroke(),window.requestAnimationFrame((function(){return e.update()}))},e}();o.decorators=[{type:t.Component,args:[{selector:"vg-modulo",template:"<canvas #waveCanvas></canvas>\n"}]}],o.propDecorators={moduloConfig:[{type:t.Input}],audioElement:[{type:t.Input}],waveCanvas:[{type:t.ViewChild,args:["waveCanvas",{static:!1}]}]};var s=function(){};s.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule],declarations:[o],exports:[o]}]}],e.Gondolo=a,e.VgModuloComponent=o,e.VgModuloModule=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=videogular-ngx-videogular-modulo.umd.min.js.map